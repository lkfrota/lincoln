<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Relat√≥rio GD-FV Paran√° - Irradia√ß√£o Solar e Pot√™ncia Instalada | Lincoln K. Frota</title>
    <meta name="description" content="An√°lise da Irradia√ß√£o Solar (GHI) Relativa e ranking dos Top 10 munic√≠pios do Paran√° com maior pot√™ncia instalada em Gera√ß√£o Distribu√≠da Fotovoltaica (GD-FV). Dados ANEEL e ERA5."/>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quantico:wght@400;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f7f4;
            color: #334155;
        }
        .font-quantico {
            font-family: 'Quantico', sans-serif;
        }
    </style>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Report",
      "headline": "Relat√≥rio GD FV Paran√° - Irradia√ß√£o Solar e Pot√™ncia Instalada",
      "description": "An√°lise da Irradia√ß√£o Solar Relativa (GHI) e ranking dos Top 10 munic√≠pios do Paran√° com maior pot√™ncia instalada em Gera√ß√£o Distribu√≠da Fotovoltaica (GD-FV). Dados ANEEL e ERA5.",
      "image": [
        "https://lkfrota.github.io/lincoln/graficos/PR_GHIrelSep2025.png",
        "https://lkfrota.github.io/lincoln/graficos/PR_GHI24Sep2025.png",
        "https://lkfrota.github.io/lincoln/graficos/top10Sep.png"
      ],
      "author": {
        "@type": "Person",
        "name": "Lincoln K. Frota",
        "url": "mailto:lkfrota@gmail.com"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Lincoln K. Frota",
        "logo": {
          "@type": "ImageObject",
          "url": "https://lkfrota.github.io/lincoln/logo.png"
        }
      },
      "datePublished": "2025-09-01",
      "dateModified": "2025-09-30"
    }
    </script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1VZWVH6B57"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-1VZWVH6B57');
    </script>
    <script>
    // URL da sua Cloud Function (API)
    const GCF_ENDPOINT = 'https://gd-pr-report-547250988053.southamerica-east1.run.app/'; 
    
    // IDs dos cont√™ineres para os mapas
    const CLIM_CONTAINER_ID = 'mapa-clim-container';
    const PREV_CONTAINER_ID = 'mapa-prev-container';
    const TOP10_CONTAINER_ID = 'top10-container';

    // Fun√ß√£o principal para carregar os gr√°ficos com base na sele√ß√£o (mensal/ytd)
    function loadNewCharts(viewType) {
        let climKey, prevKey;
        
        // Mapeamento da Visualiza√ß√£o para as Chaves da API
        if (viewType === 'ytd') {
            climKey = 'ghi_ytd_clim';
            prevKey = 'ghi_ytd_prev';
            document.getElementById('view-title-span').textContent = 'Desvio Acumulado no Ano (YTD)';
        } else {
            // Padr√£o: 'mensal'
            climKey = 'ghi_clim';
            prevKey = 'ghi_prev';
            document.getElementById('view-title-span').textContent = 'Desvio Mensal';
        }

        // 1. Chamada para o Mapa Clim/YTD Clim
        fetchAndRenderChart(climKey, CLIM_CONTAINER_ID);

        // 2. Chamada para o Mapa Prev/YTD Prev
        fetchAndRenderChart(prevKey, PREV_CONTAINER_ID);
        
        // NOTA: Para o Top 10, voc√™ pode chamar fetchAndRenderChart('top10_bar', TOP10_CONTAINER_ID); quando implementado
    }

    function fetchAndRenderChart(chartType, containerId) {
        const url = `${GCF_ENDPOINT}?chart_type=${chartType}`;
        const container = document.getElementById(containerId);
        
        // Loader/Feedback
        container.innerHTML = '<div class="text-center py-10 text-xl text-slate-400">Carregando gr√°fico...</div>'; 

        fetch(url)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Erro na API (Status ${response.status}): ${response.statusText}`);
                }
                return response.text(); 
            })
            .then(htmlContent => {
                // Injeta o HTML Plotly no cont√™iner
                container.innerHTML = htmlContent;
                // Ajusta a altura do mapa para ocupar o espa√ßo total (importante para o Plotly dentro de DIVs)
                const iframe = container.querySelector('iframe');
                if (iframe) {
                     iframe.style.height = '786px';
                     iframe.style.width = '100%';
                }
            })
            .catch(error => {
                console.error("Erro ao buscar gr√°fico:", error);
                container.innerHTML = `<p class="text-center py-10 text-red-500">Erro ao carregar o gr√°fico ${chartType}. Tente recarregar a p√°gina.</p>`;
            });
    }

    // Inicializa com os gr√°ficos mensais ao carregar a p√°gina
    document.addEventListener('DOMContentLoaded', () => {
        loadNewCharts('mensal');
        
        // Opcional: Chama o gr√°fico Top 10 (se for implementado via API)
        // fetchAndRenderChart('top10_bar', TOP10_CONTAINER_ID); 
    });
    </script>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="font-quantico text-xl md:text-2xl font-bold text-slate-700">GD Fotovoltaica no Paran√°</h1>
            <span class="text-sm text-slate-500">por Lincoln K. Frota</span>
        </nav>
    </header>

    <main class="container mx-auto px-6 py-3 md:py-6">

        <section id="visualization" class="py-3 md:py-6">
            <div class="text-center max-w-4xl mx-auto px-6">
                <h3 class="font-quantico text-3xl md:text-4xl font-bold text-slate-800 mb-4">
                    <span id="view-title-span">Desvio Irradia√ß√£o Solar (GHI) no Paran√°</span>
                </h3>
                <p class="text-slate-600 mb-8 max-w-3xl mx-auto">
                    A s√≠ntese de irradi√¢ncia global horizontal (GHI) √© refer√™ncia para gera√ß√£o el√©trica fotovoltaica. 
                    A plotagem relativa a per√≠odos anteriores facilita o comparativo em geradores em opera√ß√£o.
                </p>
                <div class="mb-8">
                    <label for="view_selector" class="text-lg font-semibold text-slate-700 mr-4">Visualiza√ß√£o:</label>
                    <select id="view_selector" onchange="loadNewCharts(this.value)" 
                            class="p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-slate-500 focus:border-slate-500">
                        <option value="mensal">Mensal (M√™s Atual vs. Hist√≥rico/Anterior)</option>
                        <option value="ytd">Acumulada (Acumulado Ano vs. Hist√≥rico/Anterior)</option>
                    </select>
                </div>
                <div id="mapa-clim-container" class="w-full max-w-4xl mx-auto mt-8 rounded-2xl shadow-2xl overflow-hidden border-4 border-white">
                    <div class="text-center py-10 text-xl text-slate-400">Carregando Dados...</div>
                </div>
                <figcaption class="p-4 text-center text-sm text-slate-500 bg-white max-w-4xl mx-auto">
                    Mapa da Irradia√ß√£o Solar (GHI) no Paran√° - Relativo a M√©dia Longa.
                </figcaption>
                <div id="mapa-prev-container" class="w-full max-w-4xl mx-auto mt-8 rounded-2xl shadow-2xl overflow-hidden border-4 border-white">
                    <div class="text-center py-10 text-xl text-slate-400">Carregando Mapa (Previs√£o/Ano Anterior)...</div>
                </div>
                <figcaption class="p-4 text-center text-sm text-slate-500 bg-white max-w-4xl mx-auto">
                    Irradia√ß√£o Solar (GHI) no Paran√° - Relativo ao Mesmo per√≠odo do Ano Passado.
                </figcaption>
                
            </div>
            
            <div class="text-center max-w-4xl mx-auto px-6 mt-16">
                <h3 class="font-quantico text-3xl md:text-4xl font-bold text-slate-800 mb-4">Top 10 Cidades em Pot√™ncia GD FV Instalada</h3>
                <p class="text-slate-600 mb-8 max-w-3xl mx-auto">
                    Este gr√°fico apresenta a evolu√ß√£o nos √∫ltimos 24 meses dos 10 munic√≠pios paranaenses com maior pot√™ncia instalada em gera√ß√£o distribu√≠da fotovoltaica atualmente, 
                    segundo dados da ANEEL disponibilizados publicamente.
                </p>
            </div>
            <div class="w-full max-w-4xl mx-auto mt-8 rounded-2xl shadow-2xl overflow-hidden border-4 border-white">
                <figure class="m-0">
                    <img src="graficos/top10Sep.png" alt="Gr√°fico Top 10 Munic√≠pios Paran√° Pot√™ncia Instalada GD" class="w-full h-auto" loading="lazy">
                    <figcaption class="p-4 text-center text-sm text-slate-500 bg-white">
                        Gr√°fico: Evolu√ß√£o 24 Meses Top 10 Munic√≠pios com Gera√ß√£o Distribu√≠da no Paran√°.
                    </figcaption>
                </figure>
            </div>
        </section>

        <section id="about" class="py-16 md:py-24 max-w-3xl mx-auto">
            <h3 class="font-quantico text-3xl md:text-4xl font-bold text-slate-800 mb-4">Sobre o Relat√≥rio</h3>
            <p class="text-slate-600 text-lg mb-4">
                Este relat√≥rio √© uma s√≠ntese dos dados de Global Horizontal Irradiance (GHI) e Gera√ß√£o Distribuida Fotovoltaica (GD-FV) para o estado brasileiro do Paran√°. 
                Visa oferecer uma vis√£o resumida das condi√ß√µes recentes para esse mercado.
                Os dados de irradi√¢ncia foram obtidos da plataforma Oikolab, que disponibiliza o modelo clim√°tico ERA5, 
                a mais recente gera√ß√£o de rean√°lise de dados produzido pela Copernicus Climate Change Service (C3S), implementado pelo ECMWF.
            </p>
            <p class="text-slate-600 text-lg">
                O GHI √© um fator cr√≠tico para a estimativa de produ√ß√£o de energia, e esta an√°lise visa ainda fornecer informa√ß√µes de refer√™ncia 
                para engenheiros, projetistas e investidores, ajudando na tomada de decis√µes estrat√©gicas e na 
                avalia√ß√£o de performance de projetos de gera√ß√£o distribu√≠da em opera√ß√£o.
            </p>
        </section>
        
        <section id="contact" class="py-16 md:py-24">
            <div class="text-center max-w-3xl mx-auto px-6">
                <h2 class="font-quantico text-3xl md:text-4xl font-bold text-slate-800 mb-4">üìû Entre em Contato</h2>
                <p class="text-slate-600 mb-10">
                    Gostou do relat√≥rio? Gostaria de reportar uma corre√ß√£o? Consultar uma aplica√ß√£o? Adapta√ß√£o? Melhoria? Entre em contato comigo pelos canais abaixo.
                </p>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-6">
                    <!-- Para usar uma imagem, substitua o emoji pela tag <img> e adicione o arquivo 'wa-logo.png' na mesma pasta. -->
                    <a href="https://wa.me/5541999358444" target="_blank" class="action-button bg-white p-6 rounded-xl shadow-md hover:shadow-xl border border-slate-200/80 flex flex-col items-center justify-center">
                        <img src="wa-logo.png" alt="Logo WhatsApp" class="w-10 h-10 mb-3 mx-auto">
                        <h3 class="font-bold text-lg text-slate-700">WhatsApp</h3>
                        <p class="text-slate-500">Envie uma mensagem</p>
                    </a>
                    <a href="tel:+5541999358444" class="action-button bg-white p-6 rounded-xl shadow-md hover:shadow-xl border border-slate-200/80 flex flex-col items-center justify-center">
                        <div class="text-4xl mb-3" aria-hidden="true">üì±</div>
                        <h3 class="font-bold text-lg text-slate-700">Ligar</h3>
                        <p class="text-slate-500" aria-label="Telefone 41 99935 8444">(41) 99935-8444</p>
                    </a>
                    <a href="mailto:lkfrota@gmail.com" class="action-button bg-white p-6 rounded-xl shadow-md hover:shadow-xl border border-slate-200/80 flex flex-col items-center justify-center">
                        <div class="text-4xl mb-3" aria-hidden="true">‚úâÔ∏è</div>
                        <h3 class="font-bold text-lg text-slate-700">E-mail</h3>
                        <p class="text-slate-500">lkfrota@gmail.com</p>
                    </a>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-slate-800 text-slate-400 py-8">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2025 Lincoln K. Frota. Todos os direitos reservados.</p>
            <p class="text-sm mt-2">GD Fotovoltaica no Paran√°.</p>
        </div>
    </footer>

</body>
</html>
